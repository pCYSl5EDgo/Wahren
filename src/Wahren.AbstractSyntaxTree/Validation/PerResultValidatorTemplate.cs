// <auto-generated>
// THIS (.cs) FILE IS GENERATED BY T4. DO NOT CHANGE IT. CHANGE THE .tt FILE INSTEAD.
// </auto-generated>
#nullable enable

namespace Wahren.AbstractSyntaxTree.Parser;

public static partial class PerResultValidator
{
	public static void AddReferenceAndValidate(ref Context context, ref Result result)
	{
		foreach (ref var node in result.PowerNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.ClassNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.DungeonNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.FieldNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.MovetypeNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.ObjectNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.RaceNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.SkillNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.SkillsetNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.SpotNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.UnitNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.VoiceNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.ScenarioNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.EventNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
		foreach (ref var node in result.StoryNodeList.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, ref node);
		}
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref PowerNode node)
	{
		ValidateBoolean(ref result, ref node.castle_battle, "Power", "castle_battle");
		ValidateBoolean(ref result, ref node.@event, "Power", "event");
		// Ignore Text Power name
		// Ignore Text Power help
		AddReference(ref result, ref node.master, ref result.UnitSet, ReferenceKind.Unit);
		AddReference(ref result, ref node.flag, ref result.flagSet, ReferenceKind.flag);
		AddReference(ref result, ref node.bgm, ref result.bgmSet, ReferenceKind.bgm);
		ValidateNumber(ref result, ref node.volume, "Power", "volume");
		ValidateBoolean(ref result, ref node.diplomacy, "Power", "diplomacy");
		ValidateBoolean(ref result, ref node.enable_select, "Power", "enable_select");
		ValidateBoolean(ref result, ref node.enable_talent, "Power", "enable_talent");
		ValidateBoolean(ref result, ref node.free_raise, "Power", "free_raise");
		ValidateNumber(ref result, ref node.money, "Power", "money");
		AddReference(ref result, ref node.home, ref result.SpotSet, ReferenceKind.Spot);
		SpecialTreatment_power_fix(ref result, ref node.fix);
		AddReference(ref result, ref node.diplo, ref result.PowerSet, ReferenceKind.Power);
		AddReference(ref result, ref node.league, ref result.PowerSet, ReferenceKind.Power);
		AddReference(ref result, ref node.enemy_power, ref result.PowerSet, ReferenceKind.Power);
		ValidateNumber(ref result, ref node.training_average, "Power", "training_average");
		ValidateNumber(ref result, ref node.base_merits, "Power", "base_merits");
		AddReference(ref result, ref node.merits, ref result.UnitSet, ReferenceKind.Unit);
		ValidateNumber(ref result, ref node.base_loyal, "Power", "base_loyal");
		AddReference(ref result, ref node.loyals, ref result.UnitSet, ReferenceKind.Unit);
		// Ignore Text Power head
		// Ignore Text Power head2
		// Ignore Text Power head3
		// Ignore Text Power head4
		// Ignore Text Power head5
		// Ignore Text Power head6
		// Ignore Text Power diff
		ValidateNumber(ref result, ref node.yabo, "Power", "yabo");
		ValidateNumber(ref result, ref node.kosen, "Power", "kosen");
		// Ignore Text Power text
		AddReference(ref result, ref node.member, ref result.SpotSet, ReferenceKind.Spot);
		AddReference(ref result, ref node.friend, ref result.ScenarioSet, ReferenceKind.Scenario);
		// Ignore Text Power master2
		// Ignore Text Power master3
		// Ignore Text Power master4
		// Ignore Text Power master5
		// Ignore Text Power master6
		// Ignore Unknown Power enable
		ValidateNumber(ref result, ref node.training_up, "Power", "training_up");
	}

	private static void SpecialTreatment_power_fix(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("home"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("hold"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("warlike"))
            {
                value.ReferenceId = 4;
            }
            else if (span.SequenceEqual("freeze"))
            {
                value.ReferenceId = 5;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Power", "fix", "off, on, home, hold, warlike, freeze", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref ClassNode node)
	{
		ValidateNumber(ref result, ref node.troop_sort, "Class", "troop_sort");
		ValidateNumber(ref result, ref node.stealth, "Class", "stealth");
		ValidateNumber(ref result, ref node.free_move, "Class", "free_move");
		// Ignore Text Class name
		// Ignore Text Class help
		SpecialTreatment_class_sex(ref result, ref node.sex);
		ValidateNumber(ref result, ref node.a, "Class", "a");
		ValidateNumber(ref result, ref node.h, "Class", "h");
		ValidateNumber(ref result, ref node.w, "Class", "w");
		// Ignore Text Class text
		ValidateBoolean(ref result, ref node.sub_image_even, "Class", "sub_image_even");
		SpecialTreatment_class_yorozu(ref result, ref node.yorozu);
		ValidateNumber(ref result, ref node.radius, "Class", "radius");
		ValidateNumber(ref result, ref node.radius_press, "Class", "radius_press");
		ValidateBoolean(ref result, ref node.no_escape, "Class", "no_escape");
		ValidateBoolean(ref result, ref node.no_regular, "Class", "no_regular");
		ValidateBooleanNumber(ref result, ref node.no_knock, "Class", "no_knock");
		ValidateBoolean(ref result, ref node.no_cover, "Class", "no_cover");
		AddReference(ref result, ref node.dead_event, ref result.EventSet, ReferenceKind.Event);
		ValidateBoolean(ref result, ref node.beast_unit, "Class", "beast_unit");
		ValidateNumber(ref result, ref node.summon_max, "Class", "summon_max");
		ValidateNumber(ref result, ref node.summon_level, "Class", "summon_level");
		ValidateNumber(ref result, ref node.attack_range, "Class", "attack_range");
		ValidateNumber(ref result, ref node.escape_range, "Class", "escape_range");
		ValidateNumber(ref result, ref node.escape_run, "Class", "escape_run");
		ValidateNumber(ref result, ref node.hand_range, "Class", "hand_range");
		ValidateNumber(ref result, ref node.wake_range, "Class", "wake_range");
		ValidateNumber(ref result, ref node.view_range, "Class", "view_range");
		ValidateNumber(ref result, ref node.cavalry_range, "Class", "cavalry_range");
		ValidateBoolean(ref result, ref node.view_unit, "Class", "view_unit");
		ValidateBoolean(ref result, ref node.force_view_unit, "Class", "force_view_unit");
		ValidateBoolean(ref result, ref node.force_blind_unit, "Class", "force_blind_unit");
		ValidateBooleanNumber(ref result, ref node.satellite, "Class", "satellite");
		ValidateNumber(ref result, ref node.hasexp, "Class", "hasexp");
		ValidateBooleanNumber(ref result, ref node.brave, "Class", "brave");
		ValidateNumber(ref result, ref node.level, "Class", "level");
		ValidateNumber(ref result, ref node.hp, "Class", "hp");
		ValidateNumber(ref result, ref node.mp, "Class", "mp");
		ValidateNumber(ref result, ref node.attack, "Class", "attack");
		ValidateNumber(ref result, ref node.defense, "Class", "defense");
		ValidateNumber(ref result, ref node.magic, "Class", "magic");
		ValidateNumber(ref result, ref node.magdef, "Class", "magdef");
		ValidateNumber(ref result, ref node.speed, "Class", "speed");
		ValidateNumber(ref result, ref node.dext, "Class", "dext");
		ValidateNumber(ref result, ref node.move, "Class", "move");
		ValidateNumber(ref result, ref node.hprec, "Class", "hprec");
		ValidateNumber(ref result, ref node.mprec, "Class", "mprec");
		ValidateNumber(ref result, ref node.heal_max, "Class", "heal_max");
		ValidateNumber(ref result, ref node.attack_max, "Class", "attack_max");
		ValidateNumber(ref result, ref node.defense_max, "Class", "defense_max");
		ValidateNumber(ref result, ref node.magic_max, "Class", "magic_max");
		ValidateNumber(ref result, ref node.magdef_max, "Class", "magdef_max");
		ValidateNumber(ref result, ref node.speed_max, "Class", "speed_max");
		ValidateNumber(ref result, ref node.dext_max, "Class", "dext_max");
		ValidateNumber(ref result, ref node.move_max, "Class", "move_max");
		ValidateNumber(ref result, ref node.hprec_max, "Class", "hprec_max");
		ValidateNumber(ref result, ref node.mprec_max, "Class", "mprec_max");
		AddReference(ref result, ref node.movetype, ref result.MovetypeSet, ReferenceKind.Movetype);
		ValidateNumber(ref result, ref node.hpUp, "Class", "hpUp");
		ValidateNumber(ref result, ref node.mpUp, "Class", "mpUp");
		ValidateNumber(ref result, ref node.attackUp, "Class", "attackUp");
		ValidateNumber(ref result, ref node.defenseUp, "Class", "defenseUp");
		ValidateNumber(ref result, ref node.magicUp, "Class", "magicUp");
		ValidateNumber(ref result, ref node.magdefUp, "Class", "magdefUp");
		ValidateNumber(ref result, ref node.speedUp, "Class", "speedUp");
		ValidateNumber(ref result, ref node.dextUp, "Class", "dextUp");
		ValidateNumber(ref result, ref node.moveUp, "Class", "moveUp");
		ValidateNumber(ref result, ref node.hprecUp, "Class", "hprecUp");
		ValidateNumber(ref result, ref node.mprecUp, "Class", "mprecUp");
		ValidateNumber(ref result, ref node.hpMax, "Class", "hpMax");
		ValidateNumber(ref result, ref node.mpMax, "Class", "mpMax");
		ValidateNumber(ref result, ref node.attackMax, "Class", "attackMax");
		ValidateNumber(ref result, ref node.defenseMax, "Class", "defenseMax");
		ValidateNumber(ref result, ref node.magicMax, "Class", "magicMax");
		ValidateNumber(ref result, ref node.magdefMax, "Class", "magdefMax");
		ValidateNumber(ref result, ref node.speedMax, "Class", "speedMax");
		ValidateNumber(ref result, ref node.dextMax, "Class", "dextMax");
		ValidateNumber(ref result, ref node.moveMax, "Class", "moveMax");
		ValidateNumber(ref result, ref node.hprecMax, "Class", "hprecMax");
		ValidateNumber(ref result, ref node.mprecMax, "Class", "mprecMax");
		AddReference(ref result, ref node.race, ref result.RaceSet, ReferenceKind.Race);
		ValidateNumber(ref result, ref node.sortkey, "Class", "sortkey");
		AddReference(ref result, ref node.picture, ref result.pictureSet, ReferenceKind.picture);
		// Ignore Unknown Class picture_atmark_cutin
		SpecialTreatment_class_picture_detail(ref result, ref node.picture_detail);
		ValidateNumber(ref result, ref node.picture_menu, "Class", "picture_menu");
		SpecialTreatment_class_picture_floor(ref result, ref node.picture_floor);
		ValidateNumber(ref result, ref node.picture_shift, "Class", "picture_shift");
		ValidateNumber(ref result, ref node.picture_shift_up, "Class", "picture_shift_up");
		ValidateNumber(ref result, ref node.picture_center, "Class", "picture_center");
		// Ignore Unknown Class picture_back
		ValidateNumber(ref result, ref node.price, "Class", "price");
		ValidateNumber(ref result, ref node.cost, "Class", "cost");
		ValidateNumber(ref result, ref node.finance, "Class", "finance");
		ValidateBoolean(ref result, ref node.tkool, "Class", "tkool");
		ValidateBooleanNumber(ref result, ref node.keep_form, "Class", "keep_form");
		ValidateNumber(ref result, ref node.breast_width, "Class", "breast_width");
		ValidateNumber(ref result, ref node.medical, "Class", "medical");
		SpecialTreatment_class_active(ref result, ref node.active);
		// Ignore Unknown Class activenum
		ValidateBoolean(ref result, ref node.handle, "Class", "handle");
		ValidateBoolean(ref result, ref node.red, "Class", "red");
		// Ignore Text Class rank_text
		ValidateBoolean(ref result, ref node.no_training, "Class", "no_training");
		ValidateBoolean(ref result, ref node.force_voice, "Class", "force_voice");
		AddReference(ref result, ref node.face, ref result.faceSet, ReferenceKind.face);
		ValidateBoolean(ref result, ref node.same_friend, "Class", "same_friend");
		ValidateBoolean(ref result, ref node.same_call, "Class", "same_call");
		ValidateNumber(ref result, ref node.level_max, "Class", "level_max");
		ValidateNumber(ref result, ref node.exp, "Class", "exp");
		ValidateNumber(ref result, ref node.exp_mul, "Class", "exp_mul");
		ValidateNumber(ref result, ref node.exp_max, "Class", "exp_max");
		SpecialTreatment_class_line(ref result, ref node.line);
		AddReference(ref result, ref node.image, ref result.imagedataSet, ReferenceKind.imagedata);
		AddReference(ref result, ref node.sub_image, ref result.imagedataSet, ReferenceKind.imagedata);
		SpecialTreatment_class_politics(ref result, ref node.politics);
		ValidateBoolean(ref result, ref node.element_lost, "Class", "element_lost");
		AddReference(ref result, ref node.fkey, ref result.ClassTypeWriterSet, ReferenceKind.ClassTypeWriter);
		AddReference(ref result, ref node.consti, ref result.AttributeTypeSet, ReferenceKind.AttributeType);
		ValidateStatusNumber(ref result, ref node.multi, "Class", "multi");
		ValidateNumber(ref result, ref node.lost_corpse, "Class", "lost_corpse");
		SpecialTreatment_class_add_vassal(ref result, ref node.add_vassal);
		ValidateNumber(ref result, ref node.value, "Class", "value");
		AddReference(ref result, ref node.@break, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.scream, ref result.soundSet, ReferenceKind.sound);
		AddReference(ref result, ref node.item, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.image2, ref result.imagedataSet, ReferenceKind.imagedata);
		AddReference(ref result, ref node.sub_image2, ref result.imagedataSet, ReferenceKind.imagedata);
		ValidateBoolean(ref result, ref node.unique, "Class", "unique");
		ValidateBoolean(ref result, ref node.same_sex, "Class", "same_sex");
		AddReference(ref result, ref node.change, ref result.ClassSet, ReferenceKind.Class);
	}

	private static void SpecialTreatment_class_sex(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("neuter"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("male"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("female"))
            {
                value.ReferenceId = 2;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Class", "sex", "neuter, male, female", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_class_yorozu(ref Result result, ref VariantPair<Pair_NullableString_NullableInt_ArrayElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("keep_direct"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("no_circle"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("base"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("keep_color"))
            {
                value.ReferenceId = 3;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Class", "yorozu", "keep_direct, no_circle, base, keep_color", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.Count: > 0 })
        {
            foreach (ref var value in pair.Value.Value.AsSpan())
            {
                Validate(ref result, ref value);
            }
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.Count: > 0 })
                {
                    foreach (ref var value in item.Value.AsSpan())
                    {
                        Validate(ref result, ref value);
                    }
                }
            }
        }
	}

	private static void SpecialTreatment_class_picture_detail(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("on1"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("on2"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("on3"))
            {
                value.ReferenceId = 4;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Class", "picture_detail", "off, on, on1, on2, on3", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_class_picture_floor(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("top"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("msg"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("base"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("bottom"))
            {
                value.ReferenceId = 3;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Class", "picture_floor", "top, msg, base, bottom", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_class_active(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("never"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("rect"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("range"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("time"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("troop"))
            {
                value.ReferenceId = 4;
            }
            else if (span.SequenceEqual("never2"))
            {
                value.ReferenceId = 5;
            }
            else if (span.SequenceEqual("rect2"))
            {
                value.ReferenceId = 6;
            }
            else if (span.SequenceEqual("range2"))
            {
                value.ReferenceId = 7;
            }
            else if (span.SequenceEqual("time2"))
            {
                value.ReferenceId = 8;
            }
            else if (span.SequenceEqual("troop2"))
            {
                value.ReferenceId = 9;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Class", "active", "never, rect, range, time, troop, never2, rect2, range2, time2, troop2", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_class_line(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("back"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("front"))
            {
                value.ReferenceId = 1;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Class", "line", "back, front", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_class_politics(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("fix"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("erase"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("unique"))
            {
                value.ReferenceId = 3;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Class", "politics", "on, fix, erase, unique", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_class_add_vassal(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("roam"))
            {
                value.ReferenceId = 2;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Class", "add_vassal", "off, on, roam", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref DungeonNode node)
	{
		// Ignore Text Dungeon name
		ValidateNumber(ref result, ref node.max, "Dungeon", "max");
		ValidateNumber(ref result, ref node.move_speed, "Dungeon", "move_speed");
		// Ignore Text Dungeon prefix
		// Ignore Text Dungeon suffix
		ValidateNumber(ref result, ref node.lv_adjust, "Dungeon", "lv_adjust");
		ValidateBoolean(ref result, ref node.open, "Dungeon", "open");
		ValidateNumber(ref result, ref node.limit, "Dungeon", "limit");
		AddReference(ref result, ref node.bgm, ref result.bgmSet, ReferenceKind.bgm);
		ValidateNumber(ref result, ref node.volume, "Dungeon", "volume");
		ValidateNumber(ref result, ref node.blind, "Dungeon", "blind");
		ValidateNumber(ref result, ref node.base_level, "Dungeon", "base_level");
		ValidateNumber(ref result, ref node.color, "Dungeon", "color");
		AddReference(ref result, ref node.map, ref result.mapSet, ReferenceKind.map);
		AddReference(ref result, ref node.floor, ref result.FieldSet, ReferenceKind.Field);
		AddReference(ref result, ref node.wall, ref result.ObjectSet, ReferenceKind.Object);
		AddReference(ref result, ref node.start, ref result.ObjectSet, ReferenceKind.Object);
		AddReference(ref result, ref node.goal, ref result.ObjectSet, ReferenceKind.Object);
		ValidateNumber(ref result, ref node.monster_num, "Dungeon", "monster_num");
		AddReference(ref result, ref node.box, ref result.ObjectSet, ReferenceKind.Object);
		// Ignore Unknown Dungeon item
		ValidateNumber(ref result, ref node.item_num, "Dungeon", "item_num");
		ValidateBoolean(ref result, ref node.item_text, "Dungeon", "item_text");
		ValidateNumber(ref result, ref node.home, "Dungeon", "home");
		ValidateNumber(ref result, ref node.ray, "Dungeon", "ray");
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref FieldNode node)
	{
		// Ignore Unknown Field type
		AddReference(ref result, ref node.attr, ref result.FieldAttributeTypeWriterSet, ReferenceKind.FieldAttributeTypeWriter);
		ValidateNumber(ref result, ref node.color, "Field", "color");
		AddReference(ref result, ref node.id, ref result.FieldIdWriterSet, ReferenceKind.FieldIdWriter);
		ValidateBoolean(ref result, ref node.edge, "Field", "edge");
		// Ignore Unknown Field joint
		// Ignore Unknown Field image
		// Ignore Unknown Field add2
		// Ignore Unknown Field member
		ValidateNumber(ref result, ref node.alt, "Field", "alt");
		ValidateNumber(ref result, ref node.alt_max, "Field", "alt_max");
		// Ignore Unknown Field smooth
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref MovetypeNode node)
	{
		// Ignore Text Movetype name
		// Ignore Text Movetype help
		AddReference(ref result, ref node.consti, ref result.FieldAttributeTypeReaderSet, ReferenceKind.FieldAttributeTypeReader);
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref ObjectNode node)
	{
		// Ignore Unknown Object skill
		// Ignore Unknown Object front
		ValidateNumber(ref result, ref node.width, "Object", "width");
		ValidateNumber(ref result, ref node.height, "Object", "height");
		ValidateNumber(ref result, ref node.alpha, "Object", "alpha");
		// Ignore Unknown Object type
		// Ignore Unknown Object breakfire
		ValidateNumber(ref result, ref node.color, "Object", "color");
		ValidateBooleanNumber(ref result, ref node.land_base, "Object", "land_base");
		ValidateBoolean(ref result, ref node.no_stop, "Object", "no_stop");
		ValidateNumber(ref result, ref node.no_wall2, "Object", "no_wall2");
		ValidateBoolean(ref result, ref node.no_arc_hit, "Object", "no_arc_hit");
		ValidateNumber(ref result, ref node.radius, "Object", "radius");
		ValidateBoolean(ref result, ref node.blk, "Object", "blk");
		ValidateNumber(ref result, ref node.w, "Object", "w");
		ValidateNumber(ref result, ref node.h, "Object", "h");
		ValidateNumber(ref result, ref node.a, "Object", "a");
		AddReference(ref result, ref node.image, ref result.imagedataSet, ReferenceKind.imagedata);
		AddReference(ref result, ref node.image2, ref result.imagedataSet, ReferenceKind.imagedata);
		ValidateNumber(ref result, ref node.image2_w, "Object", "image2_w");
		ValidateNumber(ref result, ref node.image2_h, "Object", "image2_h");
		ValidateNumber(ref result, ref node.image2_a, "Object", "image2_a");
		// Ignore Unknown Object member
		ValidateBoolean(ref result, ref node.ground, "Object", "ground");
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref RaceNode node)
	{
		// Ignore Text Race name
		ValidateNumber(ref result, ref node.align, "Race", "align");
		ValidateNumber(ref result, ref node.brave, "Race", "brave");
		AddReference(ref result, ref node.consti, ref result.AttributeTypeSet, ReferenceKind.AttributeType);
		AddReference(ref result, ref node.movetype, ref result.MovetypeSet, ReferenceKind.Movetype);
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref SkillNode node)
	{
		ValidateBoolean(ref result, ref node.bright, "Skill", "bright");
		SpecialTreatment_skill_func(ref result, ref node.func);
		// Ignore Text Skill name
		// Ignore icon Skill icon
		AddReference(ref result, ref node.fkey, ref result.SkillGroupReaderSet, ReferenceKind.SkillGroupReader);
		ValidateNumber(ref result, ref node.sortkey, "Skill", "sortkey");
		ValidateBooleanNumber(ref result, ref node.special, "Skill", "special");
		ValidateNumber(ref result, ref node.delay, "Skill", "delay");
		SpecialTreatment_skill_gun_delay(ref result, ref node.gun_delay);
		ValidateBoolean(ref result, ref node.quickreload, "Skill", "quickreload");
		// Ignore Text Skill help
		ValidateBoolean(ref result, ref node.hide_help, "Skill", "hide_help");
		AddReference(ref result, ref node.sound, ref result.soundSet, ReferenceKind.sound);
		// Ignore Text Skill msg
		AddReference(ref result, ref node.picture, ref result.pictureSet, ReferenceKind.picture);
		SpecialTreatment_skill_cutin(ref result, ref node.cutin);
		ValidateNumber(ref result, ref node.value, "Skill", "value");
		AddReferenceSkillBoolean(ref result, ref node.talent, "Skill", "talent");
		ValidateBooleanNumber(ref result, ref node.exp_per, "Skill", "exp_per");
		SpecialTreatment_skill_movetype(ref result, ref node.movetype);
		ValidateNumber(ref result, ref node.type, "Skill", "type");
		ValidateNumber(ref result, ref node.color, "Skill", "color");
		ValidateNumber(ref result, ref node.w, "Skill", "w");
		ValidateNumber(ref result, ref node.h, "Skill", "h");
		ValidateNumber(ref result, ref node.a, "Skill", "a");
		ValidateNumber(ref result, ref node.mp, "Skill", "mp");
		ValidateNumber(ref result, ref node.alpha_tip, "Skill", "alpha_tip");
		ValidateNumber(ref result, ref node.alpha_butt, "Skill", "alpha_butt");
		ValidateNumber(ref result, ref node.anime, "Skill", "anime");
		ValidateNumber(ref result, ref node.anime_interval, "Skill", "anime_interval");
		SpecialTreatment_skill_center(ref result, ref node.center);
		ValidateNumber(ref result, ref node.ground, "Skill", "ground");
		ValidateBoolean(ref result, ref node.d360, "Skill", "d360");
		ValidateNumber(ref result, ref node.d360_adj, "Skill", "d360_adj");
		ValidateNumber(ref result, ref node.rotate, "Skill", "rotate");
		SpecialTreatment_skill_direct(ref result, ref node.direct);
		ValidateNumber(ref result, ref node.resize_interval, "Skill", "resize_interval");
		ValidateNumber(ref result, ref node.resize_start, "Skill", "resize_start");
		ValidateNumber(ref result, ref node.resize_reverse, "Skill", "resize_reverse");
		ValidateNumber(ref result, ref node.resize_w, "Skill", "resize_w");
		ValidateNumber(ref result, ref node.resize_w_start, "Skill", "resize_w_start");
		ValidateNumber(ref result, ref node.resize_w_max, "Skill", "resize_w_max");
		ValidateNumber(ref result, ref node.resize_w_min, "Skill", "resize_w_min");
		ValidateNumber(ref result, ref node.resize_h_min, "Skill", "resize_h_min");
		ValidateNumber(ref result, ref node.resize_h_max, "Skill", "resize_h_max");
		ValidateNumber(ref result, ref node.resize_h_start, "Skill", "resize_h_start");
		ValidateNumber(ref result, ref node.resize_h, "Skill", "resize_h");
		ValidateNumber(ref result, ref node.resize_x, "Skill", "resize_x");
		ValidateNumber(ref result, ref node.resize_x_start, "Skill", "resize_x_start");
		ValidateNumber(ref result, ref node.resize_x_max, "Skill", "resize_x_max");
		ValidateNumber(ref result, ref node.resize_x_min, "Skill", "resize_x_min");
		ValidateNumber(ref result, ref node.resize_y_min, "Skill", "resize_y_min");
		ValidateNumber(ref result, ref node.resize_y_max, "Skill", "resize_y_max");
		ValidateNumber(ref result, ref node.resize_y_start, "Skill", "resize_y_start");
		ValidateNumber(ref result, ref node.resize_y, "Skill", "resize_y");
		ValidateNumber(ref result, ref node.resize_a, "Skill", "resize_a");
		ValidateNumber(ref result, ref node.resize_s, "Skill", "resize_s");
		ValidateNumber(ref result, ref node.resize_a_start, "Skill", "resize_a_start");
		ValidateNumber(ref result, ref node.resize_s_start, "Skill", "resize_s_start");
		ValidateNumber(ref result, ref node.resize_a_max, "Skill", "resize_a_max");
		ValidateNumber(ref result, ref node.resize_s_max, "Skill", "resize_s_max");
		ValidateNumber(ref result, ref node.resize_a_min, "Skill", "resize_a_min");
		ValidateNumber(ref result, ref node.resize_s_min, "Skill", "resize_s_min");
		ValidateBoolean(ref result, ref node.force_fire, "Skill", "force_fire");
		ValidateNumber(ref result, ref node.slow_per, "Skill", "slow_per");
		ValidateNumber(ref result, ref node.slow_time, "Skill", "slow_time");
		ValidateNumber(ref result, ref node.slide, "Skill", "slide");
		ValidateNumber(ref result, ref node.slide_speed, "Skill", "slide_speed");
		ValidateNumber(ref result, ref node.slide_delay, "Skill", "slide_delay");
		ValidateBooleanNumber(ref result, ref node.slide_stamp, "Skill", "slide_stamp");
		ValidateNumber(ref result, ref node.wait_time, "Skill", "wait_time");
		ValidateNumber(ref result, ref node.wait_time2, "Skill", "wait_time2");
		ValidateBooleanNumber(ref result, ref node.shake, "Skill", "shake");
		ValidateNumber(ref result, ref node.ray, "Skill", "ray");
		ValidateBoolean(ref result, ref node.force_ray, "Skill", "force_ray");
		ValidateNumber(ref result, ref node.flash, "Skill", "flash");
		ValidateNumber(ref result, ref node.flash_anime, "Skill", "flash_anime");
		// Ignore imagedata2 Skill flash_image
		AddReference(ref result, ref node.collision, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.afterdeath, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.afterhit, ref result.SkillSet, ReferenceKind.Skill);
		SpecialTreatment_skill_str(ref result, ref node.str);
		ValidateNumber(ref result, ref node.str_ratio, "Skill", "str_ratio");
		ValidateBoolean(ref result, ref node.add_all, "Skill", "add_all");
		ValidateNumber(ref result, ref node.add_per, "Skill", "add_per");
		SpecialTreatment_skill_damage(ref result, ref node.damage);
		ValidateNumber(ref result, ref node.damage_range_adjust, "Skill", "damage_range_adjust");
		ValidateNumber(ref result, ref node.attack_us, "Skill", "attack_us");
		ValidateBoolean(ref result, ref node.allfunc, "Skill", "allfunc");
		ValidateBoolean(ref result, ref node.bom, "Skill", "bom");
		ValidateNumber(ref result, ref node.homing2, "Skill", "homing2");
		ValidateBoolean(ref result, ref node.forward, "Skill", "forward");
		ValidateBoolean(ref result, ref node.far, "Skill", "far");
		ValidateNumber(ref result, ref node.hard, "Skill", "hard");
		ValidateBooleanNumber(ref result, ref node.hard2, "Skill", "hard2");
		ValidateBoolean(ref result, ref node.onehit, "Skill", "onehit");
		AddReference(ref result, ref node.offset_attr, ref result.SkillSet, ReferenceKind.Skill);
		ValidateNumber(ref result, ref node.knock, "Skill", "knock");
		ValidateNumber(ref result, ref node.knock_speed, "Skill", "knock_speed");
		ValidateNumber(ref result, ref node.knock_power, "Skill", "knock_power");
		ValidateNumber(ref result, ref node.range, "Skill", "range");
		ValidateNumber(ref result, ref node.range_min, "Skill", "range_min");
		ValidateNumber(ref result, ref node.check, "Skill", "check");
		ValidateNumber(ref result, ref node.speed, "Skill", "speed");
		SpecialTreatment_skill_wave(ref result, ref node.wave);
		ValidateBoolean(ref result, ref node.origin, "Skill", "origin");
		ValidateNumber(ref result, ref node.random_space, "Skill", "random_space");
		ValidateNumber(ref result, ref node.random_space_min, "Skill", "random_space_min");
		ValidateNumber(ref result, ref node.time, "Skill", "time");
		ValidateNumber(ref result, ref node.height, "Skill", "height");
		ValidateNumber(ref result, ref node.rush, "Skill", "rush");
		ValidateNumber(ref result, ref node.rush_interval, "Skill", "rush_interval");
		ValidateNumber(ref result, ref node.rush_degree, "Skill", "rush_degree");
		ValidateNumber(ref result, ref node.rush_random_degree, "Skill", "rush_random_degree");
		ValidateBooleanNumber(ref result, ref node.follow, "Skill", "follow");
		ValidateNumber(ref result, ref node.start_degree, "Skill", "start_degree");
		ValidateNumber(ref result, ref node.start_degree_fix, "Skill", "start_degree_fix");
		ValidateBoolean(ref result, ref node.start_degree_turnunit, "Skill", "start_degree_turnunit");
		ValidateNumber(ref result, ref node.start_degree_type, "Skill", "start_degree_type");
		ValidateNumber(ref result, ref node.start_random_degree, "Skill", "start_random_degree");
		ValidateNumber(ref result, ref node.drop_degree, "Skill", "drop_degree");
		ValidateNumber(ref result, ref node.drop_degree2, "Skill", "drop_degree2");
		ValidateBoolean(ref result, ref node.joint_skill, "Skill", "joint_skill");
		ValidateBoolean(ref result, ref node.send_target, "Skill", "send_target");
		ValidateBoolean(ref result, ref node.send_image_degree, "Skill", "send_image_degree");
		AddReference(ref result, ref node.next, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.next2, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.next3, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.next4, ref result.SkillSet, ReferenceKind.Skill);
		ValidateBoolean(ref result, ref node.next_order, "Skill", "next_order");
		ValidateBoolean(ref result, ref node.next_last, "Skill", "next_last");
		ValidateBoolean(ref result, ref node.next_first, "Skill", "next_first");
		ValidateNumber(ref result, ref node.next_interval, "Skill", "next_interval");
		AddReference(ref result, ref node.just_next, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.pair_next, ref result.SkillSet, ReferenceKind.Skill);
		ValidateNumber(ref result, ref node.item_type, "Skill", "item_type");
		ValidateNumber(ref result, ref node.item_sort, "Skill", "item_sort");
		ValidateBoolean(ref result, ref node.item_nosell, "Skill", "item_nosell");
		ValidateNumber(ref result, ref node.price, "Skill", "price");
		ValidateNumber(ref result, ref node.summon_level, "Skill", "summon_level");
	}

	private static void SpecialTreatment_skill_func(ref Result result, ref Pair_NullableString_NullableIntElement? value)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("missile"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("sword"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("heal"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("summon"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("charge"))
            {
                value.ReferenceId = 4;
            }
            else if (span.SequenceEqual("status"))
            {
                value.ReferenceId = 5;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Skill", "func", "missile, sword, heal, summon, charge, status", value.Text);
            }
        }

        if (value is not null)
        {
            Validate(ref result, ref value.Value);
        }
	}

	private static void SpecialTreatment_skill_cutin(ref Result result, ref VariantPair<Pair_NullableString_NullableInt_ArrayElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("type"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("top"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("y"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("y2"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("stop"))
            {
                value.ReferenceId = 4;
            }
            else if (span.SequenceEqual("wake_time"))
            {
                value.ReferenceId = 5;
            }
            else if (span.SequenceEqual("flash"))
            {
                value.ReferenceId = 6;
            }
            else if (span.SequenceEqual("phantom"))
            {
                value.ReferenceId = 7;
            }
            else if (span.SequenceEqual("alpha"))
            {
                value.ReferenceId = 8;
            }
            else if (span.SequenceEqual("zoom"))
            {
                value.ReferenceId = 9;
            }
            else if (span.SequenceEqual("inflate"))
            {
                value.ReferenceId = 10;
            }
            else if (span.SequenceEqual("slide"))
            {
                value.ReferenceId = 11;
            }
            else if (span.SequenceEqual("trans"))
            {
                value.ReferenceId = 12;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Skill", "cutin", "type, top, y, y2, stop, wake_time, flash, phantom, alpha, zoom, inflate, slide, trans", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.Count: > 0 })
        {
            foreach (ref var value in pair.Value.Value.AsSpan())
            {
                Validate(ref result, ref value);
            }
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.Count: > 0 })
                {
                    foreach (ref var value in item.Value.AsSpan())
                    {
                        Validate(ref result, ref value);
                    }
                }
            }
        }
	}

	private static void SpecialTreatment_skill_movetype(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("arc"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("drop"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("throw"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("circle"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("swing"))
            {
                value.ReferenceId = 4;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Skill", "movetype", "arc, drop, throw, circle, swing", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_skill_center(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("end"))
            {
                value.ReferenceId = 2;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Skill", "center", "off, on, end", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_skill_direct(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("roll"))
            {
                value.ReferenceId = 2;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Skill", "direct", "off, on, roll", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_skill_str(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("none"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("attack"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("magic"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("attack_magic"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("attack_dext"))
            {
                value.ReferenceId = 4;
            }
            else if (span.SequenceEqual("magic_dext"))
            {
                value.ReferenceId = 5;
            }
            else if (span.SequenceEqual("fix"))
            {
                value.ReferenceId = 6;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Skill", "str", "none, attack, magic, attack_magic, attack_dext, magic_dext, fix", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_skill_damage(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("pass"))
            {
                value.ReferenceId = 1;
            }
            else
            {
                value.HasReference = false;
                if (!value.HasNumber)
                {
                    result.ErrorAdd_UnexpectedElementSpecialValue("Skill", "damage", "off, pass", value.Text);
                }
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_skill_wave(ref Result result, ref VariantPair<Pair_NullableString_NullableInt_ArrayElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("free"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("interval"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("hold"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("fix"))
            {
                value.ReferenceId = 4;
            }
            else if (span.SequenceEqual("max"))
            {
                value.ReferenceId = 5;
            }
            else if (span.SequenceEqual("min"))
            {
                value.ReferenceId = 6;
            }
            else if (span.SequenceEqual("rotate"))
            {
                value.ReferenceId = 7;
            }
            else
            {
                value.HasReference = false;
                if (!value.HasNumber)
                {
                    result.ErrorAdd_UnexpectedElementSpecialValue("Skill", "wave", "on, free, interval, hold, fix, max, min, rotate", value.Text);
                }
            }
        }

        if (pair.Value is { HasValue: true, Value.Count: > 0 })
        {
            foreach (ref var value in pair.Value.Value.AsSpan())
            {
                Validate(ref result, ref value);
            }
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.Count: > 0 })
                {
                    foreach (ref var value in item.Value.AsSpan())
                    {
                        Validate(ref result, ref value);
                    }
                }
            }
        }
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref SkillsetNode node)
	{
		// Ignore Text Skillset name
		// Ignore icon Skillset back
		AddReference(ref result, ref node.member, ref result.SkillSet, ReferenceKind.Skill);
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref SpotNode node)
	{
		ValidateNumber(ref result, ref node.value, "Spot", "value");
		SpecialTreatment_spot_politics(ref result, ref node.politics);
		// Ignore Text Spot name
		AddReference(ref result, ref node.image, ref result.imagedataSet, ReferenceKind.imagedata);
		ValidateNumber(ref result, ref node.x, "Spot", "x");
		ValidateNumber(ref result, ref node.y, "Spot", "y");
		ValidateNumber(ref result, ref node.w, "Spot", "w");
		ValidateNumber(ref result, ref node.h, "Spot", "h");
		// Ignore Unknown Spot big
		AddReference(ref result, ref node.map, ref result.mapSet, ReferenceKind.map);
		ValidateBoolean(ref result, ref node.castle_battle, "Spot", "castle_battle");
		AddReference(ref result, ref node.yorozu, ref result.ClassSet, ReferenceKind.Class);
		ValidateNumber(ref result, ref node.limit, "Spot", "limit");
		AddReference(ref result, ref node.bgm, ref result.bgmSet, ReferenceKind.bgm);
		ValidateNumber(ref result, ref node.volume, "Spot", "volume");
		ValidateNumber(ref result, ref node.gain, "Spot", "gain");
		ValidateNumber(ref result, ref node.castle, "Spot", "castle");
		ValidateNumber(ref result, ref node.capacity, "Spot", "capacity");
		AddReference(ref result, ref node.dungeon, ref result.DungeonSet, ReferenceKind.Dungeon);
		ValidateBoolean(ref result, ref node.no_home, "Spot", "no_home");
		ValidateBoolean(ref result, ref node.no_raise, "Spot", "no_raise");
		ValidateNumber(ref result, ref node.castle_lot, "Spot", "castle_lot");
		// Ignore Text Spot text
	}

	private static void SpecialTreatment_spot_politics(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 0;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Spot", "politics", "on", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref UnitNode node)
	{
		ValidateNumber(ref result, ref node.troop_sort, "Unit", "troop_sort");
		ValidateNumber(ref result, ref node.stealth, "Unit", "stealth");
		ValidateNumber(ref result, ref node.free_move, "Unit", "free_move");
		// Ignore Text Unit name
		// Ignore Text Unit help
		SpecialTreatment_unit_sex(ref result, ref node.sex);
		ValidateNumber(ref result, ref node.a, "Unit", "a");
		ValidateNumber(ref result, ref node.h, "Unit", "h");
		ValidateNumber(ref result, ref node.w, "Unit", "w");
		// Ignore Text Unit text
		ValidateBoolean(ref result, ref node.sub_image_even, "Unit", "sub_image_even");
		SpecialTreatment_unit_yorozu(ref result, ref node.yorozu);
		ValidateNumber(ref result, ref node.radius, "Unit", "radius");
		ValidateNumber(ref result, ref node.radius_press, "Unit", "radius_press");
		ValidateBoolean(ref result, ref node.no_escape, "Unit", "no_escape");
		ValidateBoolean(ref result, ref node.no_regular, "Unit", "no_regular");
		ValidateBooleanNumber(ref result, ref node.no_knock, "Unit", "no_knock");
		ValidateBoolean(ref result, ref node.no_cover, "Unit", "no_cover");
		AddReference(ref result, ref node.dead_event, ref result.EventSet, ReferenceKind.Event);
		ValidateBoolean(ref result, ref node.beast_unit, "Unit", "beast_unit");
		ValidateNumber(ref result, ref node.summon_max, "Unit", "summon_max");
		ValidateNumber(ref result, ref node.summon_level, "Unit", "summon_level");
		ValidateNumber(ref result, ref node.attack_range, "Unit", "attack_range");
		ValidateNumber(ref result, ref node.escape_range, "Unit", "escape_range");
		ValidateNumber(ref result, ref node.escape_run, "Unit", "escape_run");
		ValidateNumber(ref result, ref node.hand_range, "Unit", "hand_range");
		ValidateNumber(ref result, ref node.wake_range, "Unit", "wake_range");
		ValidateNumber(ref result, ref node.view_range, "Unit", "view_range");
		ValidateNumber(ref result, ref node.cavalry_range, "Unit", "cavalry_range");
		ValidateBoolean(ref result, ref node.view_unit, "Unit", "view_unit");
		ValidateBoolean(ref result, ref node.force_view_unit, "Unit", "force_view_unit");
		ValidateBoolean(ref result, ref node.force_blind_unit, "Unit", "force_blind_unit");
		ValidateBooleanNumber(ref result, ref node.satellite, "Unit", "satellite");
		ValidateNumber(ref result, ref node.hasexp, "Unit", "hasexp");
		ValidateBooleanNumber(ref result, ref node.brave, "Unit", "brave");
		ValidateNumber(ref result, ref node.level, "Unit", "level");
		ValidateNumber(ref result, ref node.hp, "Unit", "hp");
		ValidateNumber(ref result, ref node.mp, "Unit", "mp");
		ValidateNumber(ref result, ref node.attack, "Unit", "attack");
		ValidateNumber(ref result, ref node.defense, "Unit", "defense");
		ValidateNumber(ref result, ref node.magic, "Unit", "magic");
		ValidateNumber(ref result, ref node.magdef, "Unit", "magdef");
		ValidateNumber(ref result, ref node.speed, "Unit", "speed");
		ValidateNumber(ref result, ref node.dext, "Unit", "dext");
		ValidateNumber(ref result, ref node.move, "Unit", "move");
		ValidateNumber(ref result, ref node.hprec, "Unit", "hprec");
		ValidateNumber(ref result, ref node.mprec, "Unit", "mprec");
		ValidateNumber(ref result, ref node.heal_max, "Unit", "heal_max");
		ValidateNumber(ref result, ref node.attack_max, "Unit", "attack_max");
		ValidateNumber(ref result, ref node.defense_max, "Unit", "defense_max");
		ValidateNumber(ref result, ref node.magic_max, "Unit", "magic_max");
		ValidateNumber(ref result, ref node.magdef_max, "Unit", "magdef_max");
		ValidateNumber(ref result, ref node.speed_max, "Unit", "speed_max");
		ValidateNumber(ref result, ref node.dext_max, "Unit", "dext_max");
		ValidateNumber(ref result, ref node.move_max, "Unit", "move_max");
		ValidateNumber(ref result, ref node.hprec_max, "Unit", "hprec_max");
		ValidateNumber(ref result, ref node.mprec_max, "Unit", "mprec_max");
		AddReference(ref result, ref node.movetype, ref result.MovetypeSet, ReferenceKind.Movetype);
		ValidateNumber(ref result, ref node.hpUp, "Unit", "hpUp");
		ValidateNumber(ref result, ref node.mpUp, "Unit", "mpUp");
		ValidateNumber(ref result, ref node.attackUp, "Unit", "attackUp");
		ValidateNumber(ref result, ref node.defenseUp, "Unit", "defenseUp");
		ValidateNumber(ref result, ref node.magicUp, "Unit", "magicUp");
		ValidateNumber(ref result, ref node.magdefUp, "Unit", "magdefUp");
		ValidateNumber(ref result, ref node.speedUp, "Unit", "speedUp");
		ValidateNumber(ref result, ref node.dextUp, "Unit", "dextUp");
		ValidateNumber(ref result, ref node.moveUp, "Unit", "moveUp");
		ValidateNumber(ref result, ref node.hprecUp, "Unit", "hprecUp");
		ValidateNumber(ref result, ref node.mprecUp, "Unit", "mprecUp");
		ValidateNumber(ref result, ref node.hpMax, "Unit", "hpMax");
		ValidateNumber(ref result, ref node.mpMax, "Unit", "mpMax");
		ValidateNumber(ref result, ref node.attackMax, "Unit", "attackMax");
		ValidateNumber(ref result, ref node.defenseMax, "Unit", "defenseMax");
		ValidateNumber(ref result, ref node.magicMax, "Unit", "magicMax");
		ValidateNumber(ref result, ref node.magdefMax, "Unit", "magdefMax");
		ValidateNumber(ref result, ref node.speedMax, "Unit", "speedMax");
		ValidateNumber(ref result, ref node.dextMax, "Unit", "dextMax");
		ValidateNumber(ref result, ref node.moveMax, "Unit", "moveMax");
		ValidateNumber(ref result, ref node.hprecMax, "Unit", "hprecMax");
		ValidateNumber(ref result, ref node.mprecMax, "Unit", "mprecMax");
		AddReference(ref result, ref node.race, ref result.RaceSet, ReferenceKind.Race);
		ValidateNumber(ref result, ref node.sortkey, "Unit", "sortkey");
		AddReference(ref result, ref node.picture, ref result.pictureSet, ReferenceKind.picture);
		// Ignore Unknown Unit picture_atmark_cutin
		SpecialTreatment_unit_picture_detail(ref result, ref node.picture_detail);
		ValidateNumber(ref result, ref node.picture_menu, "Unit", "picture_menu");
		SpecialTreatment_unit_picture_floor(ref result, ref node.picture_floor);
		ValidateNumber(ref result, ref node.picture_shift, "Unit", "picture_shift");
		ValidateNumber(ref result, ref node.picture_shift_up, "Unit", "picture_shift_up");
		ValidateNumber(ref result, ref node.picture_center, "Unit", "picture_center");
		// Ignore Unknown Unit picture_back
		ValidateNumber(ref result, ref node.price, "Unit", "price");
		ValidateNumber(ref result, ref node.cost, "Unit", "cost");
		ValidateNumber(ref result, ref node.finance, "Unit", "finance");
		ValidateBoolean(ref result, ref node.tkool, "Unit", "tkool");
		ValidateBooleanNumber(ref result, ref node.keep_form, "Unit", "keep_form");
		ValidateNumber(ref result, ref node.breast_width, "Unit", "breast_width");
		ValidateNumber(ref result, ref node.medical, "Unit", "medical");
		SpecialTreatment_unit_active(ref result, ref node.active);
		// Ignore Unknown Unit activenum
		ValidateBoolean(ref result, ref node.handle, "Unit", "handle");
		ValidateBoolean(ref result, ref node.red, "Unit", "red");
		// Ignore Text Unit rank_text
		ValidateBoolean(ref result, ref node.no_training, "Unit", "no_training");
		ValidateBoolean(ref result, ref node.force_voice, "Unit", "force_voice");
		AddReference(ref result, ref node.face, ref result.faceSet, ReferenceKind.face);
		ValidateBoolean(ref result, ref node.same_friend, "Unit", "same_friend");
		ValidateBoolean(ref result, ref node.same_call, "Unit", "same_call");
		ValidateNumber(ref result, ref node.level_max, "Unit", "level_max");
		ValidateNumber(ref result, ref node.exp, "Unit", "exp");
		ValidateNumber(ref result, ref node.exp_mul, "Unit", "exp_mul");
		ValidateNumber(ref result, ref node.exp_max, "Unit", "exp_max");
		SpecialTreatment_unit_line(ref result, ref node.line);
		AddReference(ref result, ref node.image, ref result.imagedataSet, ReferenceKind.imagedata);
		AddReference(ref result, ref node.sub_image, ref result.imagedataSet, ReferenceKind.imagedata);
		SpecialTreatment_unit_politics(ref result, ref node.politics);
		ValidateBoolean(ref result, ref node.element_lost, "Unit", "element_lost");
		AddReference(ref result, ref node.fkey, ref result.ClassTypeWriterSet, ReferenceKind.ClassTypeWriter);
		AddReference(ref result, ref node.consti, ref result.AttributeTypeSet, ReferenceKind.AttributeType);
		ValidateStatusNumber(ref result, ref node.multi, "Unit", "multi");
		ValidateNumber(ref result, ref node.lost_corpse, "Unit", "lost_corpse");
		SpecialTreatment_unit_add_vassal(ref result, ref node.add_vassal);
		ValidateNumber(ref result, ref node.value, "Unit", "value");
		AddReference(ref result, ref node.@break, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.scream, ref result.soundSet, ReferenceKind.sound);
		AddReference(ref result, ref node.item, ref result.SkillSet, ReferenceKind.Skill);
		ValidateBoolean(ref result, ref node.talent, "Unit", "talent");
		AddReference(ref result, ref node.@class, ref result.ClassSet, ReferenceKind.Class);
		AddReference(ref result, ref node.bgm, ref result.bgmSet, ReferenceKind.bgm);
		ValidateNumber(ref result, ref node.volume, "Unit", "volume");
		ValidateNumber(ref result, ref node.alive_per, "Unit", "alive_per");
		ValidateNumber(ref result, ref node.yabo, "Unit", "yabo");
		ValidateNumber(ref result, ref node.kosen, "Unit", "kosen");
		ValidateNumber(ref result, ref node.align, "Unit", "align");
		AddReference(ref result, ref node.loyal, ref result.UnitSet, ReferenceKind.Unit);
		// Ignore Text Unit power_name
		AddReference(ref result, ref node.enemy, ref result.UnitSet, ReferenceKind.Unit);
		AddReference(ref result, ref node.flag, ref result.flagSet, ReferenceKind.flag);
		ValidateBoolean(ref result, ref node.diplomacy, "Unit", "diplomacy");
		ValidateBoolean(ref result, ref node.actor, "Unit", "actor");
		ValidateNumber(ref result, ref node.enable, "Unit", "enable");
		ValidateBoolean(ref result, ref node.enable_select, "Unit", "enable_select");
		ValidateNumber(ref result, ref node.enable_max, "Unit", "enable_max");
		SpecialTreatment_unit_fix(ref result, ref node.fix);
		AddReference(ref result, ref node.home, ref result.SpotSet, ReferenceKind.Spot);
		ValidateBoolean(ref result, ref node.noremove_unit, "Unit", "noremove_unit");
		ValidateBoolean(ref result, ref node.noemploy_unit, "Unit", "noemploy_unit");
		ValidateBoolean(ref result, ref node.noitem_unit, "Unit", "noitem_unit");
		SpecialTreatment_unit_arbeit(ref result, ref node.arbeit);
		ValidateNumber(ref result, ref node.arbeit_capacity, "Unit", "arbeit_capacity");
		// Ignore Text Unit join
		// Ignore Text Unit dead
		// Ignore Text Unit retreat
		AddReference(ref result, ref node.voice_type, ref result.VoiceTypeWriterSet, ReferenceKind.VoiceTypeWriter);
	}

	private static void SpecialTreatment_unit_sex(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("neuter"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("male"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("female"))
            {
                value.ReferenceId = 2;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "sex", "neuter, male, female", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_unit_yorozu(ref Result result, ref VariantPair<Pair_NullableString_NullableInt_ArrayElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("keep_direct"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("no_circle"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("base"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("keep_color"))
            {
                value.ReferenceId = 3;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "yorozu", "keep_direct, no_circle, base, keep_color", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.Count: > 0 })
        {
            foreach (ref var value in pair.Value.Value.AsSpan())
            {
                Validate(ref result, ref value);
            }
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.Count: > 0 })
                {
                    foreach (ref var value in item.Value.AsSpan())
                    {
                        Validate(ref result, ref value);
                    }
                }
            }
        }
	}

	private static void SpecialTreatment_unit_picture_detail(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("on1"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("on2"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("on3"))
            {
                value.ReferenceId = 4;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "picture_detail", "off, on, on1, on2, on3", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_unit_picture_floor(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("top"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("msg"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("base"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("bottom"))
            {
                value.ReferenceId = 3;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "picture_floor", "top, msg, base, bottom", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_unit_active(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("never"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("rect"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("range"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("time"))
            {
                value.ReferenceId = 3;
            }
            else if (span.SequenceEqual("troop"))
            {
                value.ReferenceId = 4;
            }
            else if (span.SequenceEqual("never2"))
            {
                value.ReferenceId = 5;
            }
            else if (span.SequenceEqual("rect2"))
            {
                value.ReferenceId = 6;
            }
            else if (span.SequenceEqual("range2"))
            {
                value.ReferenceId = 7;
            }
            else if (span.SequenceEqual("time2"))
            {
                value.ReferenceId = 8;
            }
            else if (span.SequenceEqual("troop2"))
            {
                value.ReferenceId = 9;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "active", "never, rect, range, time, troop, never2, rect2, range2, time2, troop2", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_unit_line(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("back"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("front"))
            {
                value.ReferenceId = 1;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "line", "back, front", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_unit_politics(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("fix"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("erase"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("unique"))
            {
                value.ReferenceId = 3;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "politics", "on, fix, erase, unique", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_unit_add_vassal(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("roam"))
            {
                value.ReferenceId = 2;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "add_vassal", "off, on, roam", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_unit_fix(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("home"))
            {
                value.ReferenceId = 2;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "fix", "off, on, home", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	private static void SpecialTreatment_unit_arbeit(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("off"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("on"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("power"))
            {
                value.ReferenceId = 2;
            }
            else if (span.SequenceEqual("fix"))
            {
                value.ReferenceId = 3;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Unit", "arbeit", "off, on, power, fix", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref VoiceNode node)
	{
		AddReference(ref result, ref node.voice_type, ref result.VoiceTypeReaderSet, ReferenceKind.VoiceTypeReader);
		AddReference(ref result, ref node.delskill, ref result.VoiceTypeReaderSet, ReferenceKind.VoiceTypeReader);
		// Ignore Text Voice spot
		// Ignore Text Voice roam
		// Ignore Text Voice power
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref ScenarioNode node)
	{
		foreach (var statement in node.Statements.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, statement);
		}
		ValidateNumber(ref result, ref node.ws_red, "Scenario", "ws_red");
		ValidateNumber(ref result, ref node.ws_blue, "Scenario", "ws_blue");
		ValidateNumber(ref result, ref node.ws_green, "Scenario", "ws_green");
		ValidateNumber(ref result, ref node.ws_alpha, "Scenario", "ws_alpha");
		ValidateNumber(ref result, ref node.ws_light, "Scenario", "ws_light");
		ValidateNumber(ref result, ref node.ws_light_range, "Scenario", "ws_light_range");
		// Ignore Unknown Scenario discus
		// Ignore Text Scenario save_name
		ValidateBoolean(ref result, ref node.enable_select, "Scenario", "enable_select");
		ValidateNumber(ref result, ref node.max_unit, "Scenario", "max_unit");
		ValidateNumber(ref result, ref node.blind, "Scenario", "blind");
		// Ignore Text Scenario name
		AddReference(ref result, ref node.map, ref result.image_fileSet, ReferenceKind.image_file);
		// Ignore Text Scenario help
		ValidateNumber(ref result, ref node.locate_x, "Scenario", "locate_x");
		ValidateNumber(ref result, ref node.locate_y, "Scenario", "locate_y");
		// Ignore Text Scenario begin_text
		AddReference(ref result, ref node.world, ref result.EventSet, ReferenceKind.Event);
		AddReference(ref result, ref node.fight, ref result.EventSet, ReferenceKind.Event);
		AddReference(ref result, ref node.politics, ref result.EventSet, ReferenceKind.Event);
		ValidateNumber(ref result, ref node.war_capacity, "Scenario", "war_capacity");
		ValidateNumber(ref result, ref node.spot_capacity, "Scenario", "spot_capacity");
		ValidateNumber(ref result, ref node.gain_per, "Scenario", "gain_per");
		ValidateNumber(ref result, ref node.support_range, "Scenario", "support_range");
		ValidateNumber(ref result, ref node.my_range, "Scenario", "my_range");
		ValidateNumber(ref result, ref node.myhelp_range, "Scenario", "myhelp_range");
		ValidateNumber(ref result, ref node.base_level, "Scenario", "base_level");
		ValidateNumber(ref result, ref node.monster_level, "Scenario", "monster_level");
		ValidateNumber(ref result, ref node.training_up, "Scenario", "training_up");
		ValidateNumber(ref result, ref node.actor_per, "Scenario", "actor_per");
		ValidateNumber(ref result, ref node.sortkey, "Scenario", "sortkey");
		ValidateBoolean(ref result, ref node.default_ending, "Scenario", "default_ending");
		SpecialTreatment_scenario_power_order(ref result, ref node.power_order);
		ValidateBoolean(ref result, ref node.enable, "Scenario", "enable");
		ValidateBoolean(ref result, ref node.enable_talent, "Scenario", "enable_talent");
		ValidateBoolean(ref result, ref node.party, "Scenario", "party");
		ValidateBoolean(ref result, ref node.no_autosave, "Scenario", "no_autosave");
		// Ignore Unknown Scenario zone
		ValidateBoolean(ref result, ref node.nozone, "Scenario", "nozone");
		ValidateBooleanNumber(ref result, ref node.item0, "Scenario", "item0");
		ValidateBooleanNumber(ref result, ref node.item1, "Scenario", "item1");
		ValidateBooleanNumber(ref result, ref node.item2, "Scenario", "item2");
		ValidateBooleanNumber(ref result, ref node.item3, "Scenario", "item3");
		ValidateBooleanNumber(ref result, ref node.item4, "Scenario", "item4");
		ValidateBooleanNumber(ref result, ref node.item5, "Scenario", "item5");
		ValidateBooleanNumber(ref result, ref node.item6, "Scenario", "item6");
		ValidateBoolean(ref result, ref node.item_limit, "Scenario", "item_limit");
		// Ignore Unknown Scenario poli
		// Ignore Unknown Scenario camp
		// Ignore Unknown Scenario multi
		// Ignore Unknown Scenario item
		AddReference(ref result, ref node.item_sale, ref result.SkillSet, ReferenceKind.Skill);
		AddReference(ref result, ref node.item_hold, ref result.SkillSet, ReferenceKind.Skill);
		// Ignore Text Scenario text
		AddReference(ref result, ref node.roam, ref result.UnitSet, ReferenceKind.Unit);
		AddReference(ref result, ref node.spot, ref result.SpotSet, ReferenceKind.Spot);
		AddReference(ref result, ref node.power, ref result.PowerSet, ReferenceKind.Power);
		// Ignore Unknown Scenario offset
	}

	private static void SpecialTreatment_scenario_power_order(ref Result result, ref VariantPair<Pair_NullableString_NullableIntElement> pair)
	{
		static void Validate(ref Result result, ref Pair_NullableString_NullableInt value)
        {
            var span = result.GetSpan(value.Text);
			value.HasReference = true;
			value.ReferenceKind = ReferenceKind.Special;
            if (span.SequenceEqual("normal"))
            {
                value.ReferenceId = 0;
            }
            else if (span.SequenceEqual("test"))
            {
                value.ReferenceId = 1;
            }
            else if (span.SequenceEqual("dash"))
            {
                value.ReferenceId = 2;
            }
            else
            {
                value.HasReference = false;
                result.ErrorAdd_UnexpectedElementSpecialValue("Scenario", "power_order", "normal, test, dash", value.Text);
            }
        }

        if (pair.Value is { HasValue: true, Value.HasText: true })
        {
            Validate(ref result, ref pair.Value.Value);
        }

        if (pair.VariantArray is not null)
        {
            foreach (var item in pair.VariantArray)
            {
                if (item is { HasValue: true, Value.HasText: true })
                {
                    Validate(ref result, ref item.Value);
                }
            }
        }
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref EventNode node)
	{
		foreach (var statement in node.Statements.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, statement);
		}
		ValidateBoolean(ref result, ref node.disperse, "Event", "disperse");
		ValidateNumber(ref result, ref node.castle, "Event", "castle");
		ValidateBoolean(ref result, ref node.castle_battle, "Event", "castle_battle");
		ValidateBooleanNumber(ref result, ref node.blind, "Event", "blind");
		ValidateNumber(ref result, ref node.w, "Event", "w");
		ValidateNumber(ref result, ref node.h, "Event", "h");
		// Ignore Unknown Event bg
		// Ignore Unknown Event bcg
		AddReference(ref result, ref node.bgm, ref result.bgmSet, ReferenceKind.bgm);
		AddReference(ref result, ref node.map, ref result.mapSet, ReferenceKind.map);
		// Ignore Text Event name
		// Ignore Unknown Event size
		ValidateNumber(ref result, ref node.color, "Event", "color");
		// Ignore Unknown Event block
		ValidateNumber(ref result, ref node.limit, "Event", "limit");
		// Ignore Text Event title
		// Ignore Unknown Event center
		// Ignore Unknown Event italic
		ValidateRedBlue(ref result, ref node.handle, "Event", "handle");
		// Ignore Unknown Event member
		// Ignore Unknown Event second
		ValidateNumber(ref result, ref node.volume, "Event", "volume");
		// Ignore Unknown Event bg_fade
		// Ignore Unknown Event dark_fade
		// Ignore Unknown Event dark_alpha
		// Ignore Unknown Event bg_interval
		// Ignore Unknown Event dark_fade_e
		// Ignore Unknown Event last_second
	}

	public static void AddReferenceAndValidate(ref Context context, ref Result result, ref StoryNode node)
	{
		foreach (var statement in node.Statements.AsSpan())
		{
			AddReferenceAndValidate(ref context, ref result, statement);
		}
		AddReference(ref result, ref node.friend, ref result.ScenarioSet, ReferenceKind.Scenario);
		ValidateBoolean(ref result, ref node.fight, "Story", "fight");
	}
}
