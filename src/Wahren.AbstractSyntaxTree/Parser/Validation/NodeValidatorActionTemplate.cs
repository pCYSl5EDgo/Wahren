// <auto-generated>
// THIS (.cs) FILE IS GENERATED BY T4. DO NOT CHANGE IT. CHANGE THE .tt FILE INSTEAD.
// </auto-generated>
#nullable enable
using Wahren.AbstractSyntaxTree.Element;
using Wahren.AbstractSyntaxTree.Element.Statement;

namespace Wahren.AbstractSyntaxTree.Parser;

public static partial class NodeValidator
{
    public static void AddReferenceAndValidate(ref Context context, ref Result result, CallActionStatement statement)
    {
        var arguments = statement.Arguments.AsSpan();
        if (arguments.IsEmpty)
        {
            return;
        }

        ref var argument = ref arguments[0];
        ReadOnlySpan<char> span;
        switch (statement.Kind)
        {
            case ActionKind.vc:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'vc'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.play:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'play'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.ppl1:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'ppl1'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.citom:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'citom'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.setbcg:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'setbcg'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.levelup:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'levelup'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.showCamp:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'showCamp'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.pushDeath:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'pushDeath'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.clickWait:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'clickWait'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.worldskin:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'worldskin'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.storeDeath:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'storeDeath'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.darkness_off:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'darkness_off'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.doGameEnding:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'doGameEnding'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.setPowerHome:
                if (context.CreateError(DiagnosticSeverity.Warning))
                {
                    result.ErrorList.Add(new($"Unknown action 'setPowerHome'.", result.TokenList[statement.TokenId].Range, DiagnosticSeverity.Warning));
                }
                break;
            case ActionKind.stopTroop:
                
                break;
            case ActionKind.loopBGM:
                argument.ReferenceKind = ReferenceKind.bgm;
                argument.ReferenceId = result.bgmSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                for (int i = 1; i < arguments.Length; ++i)
                {
                    argument = ref arguments[i];
                    argument.ReferenceKind = ReferenceKind.bgm;
                    argument.ReferenceId = result.bgmSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;

                }
                break;
            case ActionKind.eraseSkill:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'eraseSkill'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.eraseFriend:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'eraseFriend'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.msg:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        argument.ReferenceKind = ReferenceKind.face;
                        argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
                        break;
                }
                break;
            case ActionKind.msg2:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        argument.ReferenceKind = ReferenceKind.face;
                        argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
                        break;
                }
                break;
            case ActionKind.talk:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        argument.ReferenceKind = ReferenceKind.face;
                        argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
                        break;
                }
                break;
            case ActionKind.talk2:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        argument.ReferenceKind = ReferenceKind.face;
                        argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
                        break;
                }
                break;
            case ActionKind.chat:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        argument.ReferenceKind = ReferenceKind.face;
                        argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
                        break;
                }
                break;
            case ActionKind.chat2:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        argument.ReferenceKind = ReferenceKind.face;
                        argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
                        break;
                }
                break;
            case ActionKind.@event:
                argument.ReferenceKind = ReferenceKind.Event;
                argument.ReferenceId = result.EventSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.Power;
                argument.ReferenceId = result.PowerSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                argument.ReferenceKind = ReferenceKind.Power;
                argument.ReferenceId = result.PowerSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.changeMaster:
                switch (arguments.Length)
                {
                    case 1:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changeMaster'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Unit;
                            argument.HasReference = true;
                        }
break;
                    case 2:
                                                argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'changeMaster'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Unit;
                            argument.HasReference = true;
                        }
break;
                    case 3:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changeMaster'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Unit;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'changeMaster'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Unit;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        argument.ReferenceKind = ReferenceKind.flag;
                        argument.ReferenceId = result.flagSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
break;
                }
                break;
            case ActionKind.dialog:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                                                break;
                }
                break;
            case ActionKind.dialogF:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                                                break;
                }
                break;
            case ActionKind.hideImage:
                argument.ReferenceKind = ReferenceKind.image_file;
                argument.ReferenceId = result.image_fileSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.hideFace:
                argument.ReferenceKind = ReferenceKind.face;
                argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.hidePicture:
                argument.ReferenceKind = ReferenceKind.picture;
                argument.ReferenceId = result.pictureSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.bg:
                argument.ReferenceKind = ReferenceKind.image_file;
                argument.ReferenceId = result.image_fileSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 1-th argument of action 'bg' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
            case ActionKind.locate:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.scroll:
                switch (arguments.Length)
                {
                    case 1:
                        break;
                    case 2:
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.addSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'addSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.showSpotMark:
                
                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 1-th argument of action 'showSpotMark' must be Number.");
                }

                break;
            case ActionKind.resetTruce:
                switch (arguments.Length)
                {
                    case 1:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'resetTruce'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.HasReference = true;
                            }
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        else
                        {
                            if (context.CreateError(DiagnosticSeverity.Warning))
                            {
                                result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                            }
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                            argument.HasReference = true;
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
break;
                    case 2:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'resetTruce'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'resetTruce'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.resetLeague:
                switch (arguments.Length)
                {
                    case 1:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'resetLeague'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.HasReference = true;
                            }
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        else
                        {
                            if (context.CreateError(DiagnosticSeverity.Warning))
                            {
                                result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                            }
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                            argument.HasReference = true;
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
break;
                    case 2:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'resetLeague'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'resetLeague'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.resetEnemyPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'resetEnemyPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'resetEnemyPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.image:
                argument.ReferenceKind = ReferenceKind.image_file;
                argument.ReferenceId = result.image_fileSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.image2:
                argument.ReferenceKind = ReferenceKind.image_file;
                argument.ReferenceId = result.image_fileSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.showImage:
                argument.ReferenceKind = ReferenceKind.image_file;
                argument.ReferenceId = result.image_fileSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.face:
                argument.ReferenceKind = ReferenceKind.face;
                argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.face2:
                argument.ReferenceKind = ReferenceKind.face;
                argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.showFace:
                argument.ReferenceKind = ReferenceKind.face;
                argument.ReferenceId = result.faceSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.picture:
                argument.ReferenceKind = ReferenceKind.picture;
                argument.ReferenceId = result.pictureSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.picture2:
                argument.ReferenceKind = ReferenceKind.picture;
                argument.ReferenceId = result.pictureSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.showPict:
                argument.ReferenceKind = ReferenceKind.picture;
                argument.ReferenceId = result.pictureSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.showPicture:
                argument.ReferenceKind = ReferenceKind.picture;
                argument.ReferenceId = result.pictureSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.add:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.div:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.mod:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.mul:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.per:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.set:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.sub:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addv:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addv'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.Length > 1 && span[0] == '@')
                {
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.setv:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setv'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.Length > 1 && span[0] == '@')
                {
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.subv:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'subv'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.Length > 1 && span[0] == '@')
                {
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.setPM:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setPM'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.setud:
                argument.ReferenceKind = ReferenceKind.GlobalStringVariableReader;
                argument.ReferenceId = result.GlobalStringVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'setud'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.title:
                
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addstr:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addstr'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                
                break;
            case ActionKind.addVar:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addVar'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.Length > 1 && span[0] == '@')
                {
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.select:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                
                break;
            case ActionKind.setVar:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setVar'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.Length > 1 && span[0] == '@')
                {
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.subVar:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'subVar'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.Length > 1 && span[0] == '@')
                {
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.title2:
                
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addCapa:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addCapa'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addGain:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addGain'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.pushSex:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushSex'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushVar:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushVar'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.setCapa:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setCapa'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.setDone:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setDone'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 1-th argument of action 'setDone' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
            case ActionKind.setGain:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setGain'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.storePM:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storePM'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storePM'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeud:
                argument.ReferenceKind = ReferenceKind.GlobalStringVariableWriter;
                argument.ReferenceId = result.GlobalStringVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeud'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                break;
            case ActionKind.addLevel:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addLevel'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addLoyal:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addLoyal'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addMoney:
                
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addTrust:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addTrust'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.hideLink:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'hideLink'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'hideLink'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.pushCapa:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushCapa'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushGain:
                
                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushItem:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushItem'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Skill;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushRank:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushRank'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.setLevel:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setLevel'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.setMoney:
                
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.hideEscape:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'hideEscape'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'hideEscape'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addCastle:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addCastle'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addMerits:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addMerits'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.changeMap:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changeMap'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.map;
                argument.ReferenceId = result.mapSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.formTroop:
                
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.pushForce:
                
                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushLevel:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushLevel'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushLoyal:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushLoyal'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushMoney:
                
                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushTrain:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushTrain'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushTrust:
                
                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.setCastle:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setCastle'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.changeRace:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changeRace'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'changeRace'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.RaceSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Race;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.pushCastle:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushCastle'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushMerits:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushMerits'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.setDungeon:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setDungeon'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.Dungeon;
                argument.ReferenceId = result.DungeonSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.speedTroop:
                
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.unionPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'unionPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'unionPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addTraining:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addTraining'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.changeClass:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changeClass'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'changeClass'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.ClassSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Class;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.pushTrainUp:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushTrainUp'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.removeSkill:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'removeSkill'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.setTraining:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setTraining'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addBaseLevel:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addBaseLevel'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.changeCastle:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changeCastle'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.setBaseLevel:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setBaseLevel'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addTrainingUp:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addTrainingUp'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.changeDungeon:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changeDungeon'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.Dungeon;
                argument.ReferenceId = result.DungeonSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushBaseLevel:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushBaseLevel'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.setTrainingUp:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setTrainingUp'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.storeNextSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeNextSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeNextSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeSkillset:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeSkillset'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SkillsetSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Skillset;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeSkillset'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeTodoUnit:
                
                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeTodoUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.changePowerFix:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changePowerFix'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.pushBattleHome:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushBattleRect:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.storeAliveUnit:
                
                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeAliveUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.changePowerFlag:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changePowerFlag'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.changePowerName:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changePowerName'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.changeSpotImage:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changeSpotImage'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.imagedata;
                argument.ReferenceId = result.imagedataSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.setDungeonFloor:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setDungeonFloor'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.DungeonSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Dungeon;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.storeRaceOfUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeRaceOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeRaceOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeSpotOfUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeSpotOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeSpotOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeUnitOfSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeUnitOfSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeUnitOfSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeClassOfUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeClassOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeClassOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storePowerOfSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storePowerOfSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storePowerOfSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storePowerOfUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storePowerOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storePowerOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeSkillOfUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeSkillOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeSkillOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeSpotOfPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeSpotOfPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeSpotOfPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeTalentPower:
                argument.ReferenceKind = ReferenceKind.Unit;
                argument.ReferenceId = result.UnitSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeTalentPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeUnitOfPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeUnitOfPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeUnitOfPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeLeaderOfSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeLeaderOfSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeLeaderOfSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeMasterOfUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeMasterOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeMasterOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeMemberOfUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeMemberOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeMemberOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storePowerOfForce:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storePowerOfForce'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeLeaderOfPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeLeaderOfPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeLeaderOfPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeMasterOfPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeMasterOfPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeMasterOfPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeRoamUnitOfSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeRoamUnitOfSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeRoamUnitOfSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeBaseClassOfUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeBaseClassOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'storeBaseClassOfUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"1-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"1-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.call:
                argument.ReferenceKind = ReferenceKind.Event;
                argument.ReferenceId = result.EventSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.zoom:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.clear:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'clear'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.playSE:
                argument.ReferenceKind = ReferenceKind.se;
                argument.ReferenceId = result.seSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.volume:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addItem:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addItem'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Skill;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.routine:
                argument.ReferenceKind = ReferenceKind.Event;
                argument.ReferenceId = result.EventSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.scroll2:
                
                break;
            case ActionKind.shuffle:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'shuffle'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                break;
            case ActionKind.addLimit:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.addPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.clearVar:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'clearVar'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                break;
            case ActionKind.exitItem:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'exitItem'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Skill;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.hideSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'hideSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.pushRand:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushTurn:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.roamUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'roamUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.roamUnit2:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'roamUnit2'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.setLimit:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.showSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'showSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.showParty:
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 0-th argument of action 'showParty' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
            case ActionKind.ctrlTroop:
                
                break;
            case ActionKind.entryItem:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'entryItem'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Skill;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.eraseItem:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'eraseItem'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Skill;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.eraseUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'eraseUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.freeTroop:
                
                break;
            case ActionKind.haltTroop:
                
                break;
            case ActionKind.hideChara:
                argument.ReferenceKind = ReferenceKind.imagedata;
                argument.ReferenceId = result.imagedataSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushLimit:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushRand2:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.endingRoll:
                argument.ReferenceKind = ReferenceKind.Event;
                argument.ReferenceId = result.EventSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.erasePower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'erasePower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.eraseTroop:
                
                break;
            case ActionKind.removeSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'removeSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.shuffleVar:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'shuffleVar'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                break;
            case ActionKind.sleepTroop:
                
                break;
            case ActionKind.activeTroop:
                
                break;
            case ActionKind.battleEvent:
                argument.ReferenceKind = ReferenceKind.Event;
                argument.ReferenceId = result.EventSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.removeTroop:
                
                break;
            case ActionKind.scrollSpeed:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.showDungeon:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'showDungeon'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.DungeonSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Dungeon;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.unctrlTroop:
                
                break;
            case ActionKind.retreatTroop:
                
                break;
            case ActionKind.reverseChara:
                argument.ReferenceKind = ReferenceKind.imagedata;
                argument.ReferenceId = result.imagedataSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.showPolitics:
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 0-th argument of action 'showPolitics' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
            case ActionKind.storeAllSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeAllSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeAllPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeAllPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeComPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeComPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeNowPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeNowPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.eraseUnitTroop:
                
                break;
            case ActionKind.pushCountPower:
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.storeAllTalent:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeAllTalent'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.erasePowerMerce:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'erasePowerMerce'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.erasePowerStaff:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'erasePowerStaff'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.storeBattleSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeBattleSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storePlayerUnit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storePlayerUnit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeAttackPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeAttackPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeNeutralSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeNeutralSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storePlayerPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storePlayerPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeDefensePower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeDefensePower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeSpotOfBattle:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeSpotOfBattle'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storePowerOfAttack:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storePowerOfAttack'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeNonPlayerPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeNonPlayerPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storePowerOfDefense:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storePowerOfDefense'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.exit:
                
                break;
            case ActionKind.wait:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.focus:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'focus'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.shake:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.fadein:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.fadeout:
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.playBGM:
                argument.ReferenceKind = ReferenceKind.bgm;
                argument.ReferenceId = result.bgmSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.reloadMenu:
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 0-th argument of action 'reloadMenu' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
            case ActionKind.choiceTitle:
                
                break;
            case ActionKind.changePlayer:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'changePlayer'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                break;
            case ActionKind.setGameClear:
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 0-th argument of action 'setGameClear' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
            case ActionKind.font:
                argument.ReferenceKind = ReferenceKind.font;
                argument.ReferenceId = result.fontSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 1-th argument of action 'font' must be Number.");
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 2-th argument of action 'font' must be Number.");
                }

                break;
            case ActionKind.fontc:
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 0-th argument of action 'fontc' must be Number.");
                }

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 1-th argument of action 'fontc' must be Number.");
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 2-th argument of action 'fontc' must be Number.");
                }

                break;
            case ActionKind.gread:
                
                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"2-th argument is empty. String Variable is required by action 'gread'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"2-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"2-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.pushv:
                switch (arguments.Length)
                {
                    case 2:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushv'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.HasReference = true;
                            }
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        else
                        {
                            if (context.CreateError(DiagnosticSeverity.Warning))
                            {
                                result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                            }
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                            argument.HasReference = true;
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        argument = ref arguments[1];
                        argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                        argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
break;
                    case 3:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushv'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.HasReference = true;
                            }
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        else
                        {
                            if (context.CreateError(DiagnosticSeverity.Warning))
                            {
                                result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                            }
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                            argument.HasReference = true;
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.Length > 1 && span[0] == '@')
                        {
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                        argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                        argument.HasReference = true;
break;
                }
                break;
            case ActionKind.gwrite:
                
                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"2-th argument is empty. String Variable is required by action 'gwrite'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"2-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                break;
            case ActionKind.addUnit:
                // skip addUnit
                break;
            case ActionKind.addDiplo:
                switch (arguments.Length)
                {
                    case 2:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addDiplo'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.HasReference = true;
                            }
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        else
                        {
                            if (context.CreateError(DiagnosticSeverity.Warning))
                            {
                                result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                            }
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                            argument.HasReference = true;
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                    case 3:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addDiplo'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'addDiplo'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.aimTroop:
                switch (arguments.Length)
                {
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.setDiplo:
                switch (arguments.Length)
                {
                    case 2:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setDiplo'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.HasReference = true;
                            }
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        else
                        {
                            if (context.CreateError(DiagnosticSeverity.Warning))
                            {
                                result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                            }
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                            argument.HasReference = true;
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                    case 3:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setDiplo'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'setDiplo'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.setTruce:
                switch (arguments.Length)
                {
                    case 2:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setTruce'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.HasReference = true;
                            }
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        else
                        {
                            if (context.CreateError(DiagnosticSeverity.Warning))
                            {
                                result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                            }
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                            argument.HasReference = true;
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                    case 3:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setTruce'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'setTruce'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.equipItem:
                // skip equipItem
                break;
            case ActionKind.setLeague:
                switch (arguments.Length)
                {
                    case 2:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setLeague'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.HasReference = true;
                            }
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        else
                        {
                            if (context.CreateError(DiagnosticSeverity.Warning))
                            {
                                result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                            }
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                            argument.HasReference = true;
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        }
                        argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                    case 3:
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setLeague'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[1];
                        span = result.GetSpan(argument.TokenId);
                        if (span.IsEmpty)
                        {
                            result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'setLeague'.", result.TokenList[argument.TokenId].Range));
                        }
                        else if (span[0] == '@')
                        {
                            if (span.Length != 1)
                            {
                                argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                                argument.ReferenceKind = ReferenceKind.StringVariableReader;
                                argument.HasReference = true;
                            }
                        }
                        else
                        {
                            argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.Power;
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.skillTroop:
                // skip skillTroop
                break;
            case ActionKind.index:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'index'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"2-th argument is empty. String Variable is required by action 'index'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"2-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"2-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeIndex:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeIndex'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"2-th argument is empty. String Variable is required by action 'storeIndex'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"2-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"2-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.storeIndexVar:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'storeIndexVar'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableReader;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"2-th argument is empty. String Variable is required by action 'storeIndexVar'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"2-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"2-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                break;
            case ActionKind.pushCon:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushCon'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                
                argument = ref arguments[2];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.addStatus:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addStatus'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.pushDiplo:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushDiplo'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'pushDiplo'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.setArbeit:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setArbeit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'setArbeit'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.setStatus:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setStatus'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.pushStatus:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushStatus'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber && (argument.HasReference = IsStatus(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Status;
                }
                else
                {
                    result.ErrorList.Add(new($"The 1-th argument of action 'pushStatus' must be Status.", result.TokenList[argument.TokenId].Range));
                }

                argument = ref arguments[2];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.pushSpotPos:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'pushSpotPos'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[2];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.setEnemyPower:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'setEnemyPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'setEnemyPower'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.choice:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'choice'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length == 1)
                    {
                        result.ErrorList.Add(new($"0-th argument '@' must be String Variable.", result.TokenList[argument.TokenId].Range));
                    }
                    else
                    {
                        argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.HasReference = true;
                    }
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }
                else
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"0-th argument '{span}' is String Variable. '@' should be written.", result.TokenList[argument.TokenId].Range));
                    }
                    argument.ReferenceId = result.StringVariableWriterSet.GetOrAdd(span, argument.TokenId);
                    argument.HasReference = true;
                    argument.ReferenceKind = ReferenceKind.StringVariableWriter;
                }

                
                break;
            case ActionKind.addSkill:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addSkill'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'addSkill'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Skill;
                    argument.HasReference = true;
                }

                for (int i = 2; i < arguments.Length; ++i)
                {
                    argument = ref arguments[i];
                    span = result.GetSpan(argument.TokenId);
                    if (span.IsEmpty)
                    {
                        result.ErrorList.Add(new($"{i}-th argument is empty. String Variable is required by action 'addSkill'.", result.TokenList[argument.TokenId].Range));
                    }
                    else if (span[0] == '@')
                    {
                        if (span.Length != 1)
                        {
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                            argument.HasReference = true;
                        }
                    }
                    else
                    {
                        argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.Skill;
                        argument.HasReference = true;
                    }

                }
                break;
            case ActionKind.addFriend:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addFriend'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.addSkill2:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addSkill2'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'addSkill2'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Skill;
                    argument.HasReference = true;
                }

                for (int i = 2; i < arguments.Length; ++i)
                {
                    argument = ref arguments[i];
                    span = result.GetSpan(argument.TokenId);
                    if (span.IsEmpty)
                    {
                        result.ErrorList.Add(new($"{i}-th argument is empty. String Variable is required by action 'addSkill2'.", result.TokenList[argument.TokenId].Range));
                    }
                    else if (span[0] == '@')
                    {
                        if (span.Length != 1)
                        {
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                            argument.HasReference = true;
                        }
                    }
                    else
                    {
                        argument.ReferenceId = result.SkillSet.GetOrAdd(span, argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.Skill;
                        argument.HasReference = true;
                    }

                }
                break;
            case ActionKind.eraseUnit2:
                
                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'eraseUnit2'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                for (int i = 2; i < arguments.Length; ++i)
                {
                    argument = ref arguments[i];
                    span = result.GetSpan(argument.TokenId);
                    if (span.IsEmpty)
                    {
                        result.ErrorList.Add(new($"{i}-th argument is empty. String Variable is required by action 'eraseUnit2'.", result.TokenList[argument.TokenId].Range));
                    }
                    else if (span[0] == '@')
                    {
                        if (span.Length != 1)
                        {
                            argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                            argument.ReferenceKind = ReferenceKind.StringVariableReader;
                            argument.HasReference = true;
                        }
                    }
                    else
                    {
                        argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.Unit;
                        argument.HasReference = true;
                    }

                }
                break;
            case ActionKind.addPowerMerce:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addPowerMerce'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.addPowerStaff:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addPowerStaff'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.addPowerMerce2:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addPowerMerce2'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.addPowerStaff2:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'addPowerStaff2'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.PowerSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Power;
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.shadow:
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 0-th argument of action 'shadow' must be Number.");
                }

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 1-th argument of action 'shadow' must be Number.");
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 2-th argument of action 'shadow' must be Number.");
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 3-th argument of action 'shadow' must be Number.");
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 4-th argument of action 'shadow' must be Number.");
                }

                if (arguments.Length <= 5)
                {
                    break;
                }
                argument = ref arguments[5];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 5-th argument of action 'shadow' must be Number.");
                }

                break;
            case ActionKind.doskill:
                argument.ReferenceKind = ReferenceKind.Skill;
                argument.ReferenceId = result.SkillSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[4];
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 4-th argument of action 'doskill' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
            case ActionKind.addTroop:
                
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                
                break;
            case ActionKind.storeRectUnit:
                if (!argument.IsNumber && (argument.HasReference = IsRedBlue(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.RedBlue;
                }
                else
                {
                    result.ErrorList.Add(new($"The 0-th argument of action 'storeRectUnit' must be RedBlue.", result.TokenList[argument.TokenId].Range));
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[5];
                argument.ReferenceKind = ReferenceKind.NumberVariableWriter;
                argument.ReferenceId = result.NumberVariableWriterSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                break;
            case ActionKind.darkness:
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 0-th argument of action 'darkness' must be Number.");
                }

                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 1-th argument of action 'darkness' must be Number.");
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 2-th argument of action 'darkness' must be Number.");
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 3-th argument of action 'darkness' must be Number.");
                }

                break;
            case ActionKind.linkSpot:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'linkSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'linkSpot'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                argument.ReferenceKind = ReferenceKind.imagedata;
                argument.ReferenceId = result.imagedataSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 3-th argument of action 'linkSpot' must be Number.");
                }

                break;
            case ActionKind.moveTroop:
                switch (arguments.Length)
                {
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                    case 4:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[3];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.moveTroopFix:
                switch (arguments.Length)
                {
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                    case 4:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[3];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.smoveTroop:
                switch (arguments.Length)
                {
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                    case 4:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[3];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.smoveTroopFix:
                switch (arguments.Length)
                {
                    case 2:
                                                break;
                    case 3:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                    case 4:
                                                argument = ref arguments[1];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[2];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
                        argument = ref arguments[3];
                        if (!argument.IsNumber)
                        {
                            argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                            argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                            argument.HasReference = true;
                        }
break;
                }
                break;
            case ActionKind.linkEscape:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'linkEscape'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"1-th argument is empty. String Variable is required by action 'linkEscape'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.SpotSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Spot;
                    argument.HasReference = true;
                }

                if (arguments.Length <= 2)
                {
                    break;
                }
                argument = ref arguments[2];
                argument.ReferenceKind = ReferenceKind.imagedata;
                argument.ReferenceId = result.imagedataSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 3-th argument of action 'linkEscape' must be Number.");
                }

                break;
            case ActionKind.spotmark:
                
                if (arguments.Length <= 1)
                {
                    break;
                }
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    result.ErrorAdd_NumberIsExpected(argument.TokenId, $" The 1-th argument of action 'spotmark' must be Number.");
                }

                break;
            case ActionKind.showChara:
                argument.ReferenceKind = ReferenceKind.imagedata;
                argument.ReferenceId = result.imagedataSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                argument.HasReference = true;

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 4)
                {
                    break;
                }
                argument = ref arguments[4];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                break;
            case ActionKind.shiftTroop:
                
                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                if (arguments.Length <= 3)
                {
                    break;
                }
                argument = ref arguments[3];
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 3-th argument of action 'shiftTroop' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
            case ActionKind.shiftTroop2:
                span = result.GetSpan(argument.TokenId);
                if (span.IsEmpty)
                {
                    result.ErrorList.Add(new($"0-th argument is empty. String Variable is required by action 'shiftTroop2'.", result.TokenList[argument.TokenId].Range));
                }
                else if (span[0] == '@')
                {
                    if (span.Length != 1)
                    {
                        argument.ReferenceId = result.StringVariableReaderSet.GetOrAdd(span.Slice(1), argument.TokenId);
                        argument.ReferenceKind = ReferenceKind.StringVariableReader;
                        argument.HasReference = true;
                    }
                }
                else
                {
                    argument.ReferenceId = result.UnitSet.GetOrAdd(span, argument.TokenId);
                    argument.ReferenceKind = ReferenceKind.Unit;
                    argument.HasReference = true;
                }

                argument = ref arguments[1];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[2];
                if (!argument.IsNumber)
                {
                    argument.ReferenceKind = ReferenceKind.NumberVariableReader;
                    argument.ReferenceId = result.NumberVariableReaderSet.GetOrAdd(result.GetSpan(argument.TokenId), argument.TokenId);
                    argument.HasReference = true;
                }

                argument = ref arguments[3];
                if (!argument.IsNumber && (argument.HasReference = IsBoolean(result.GetSpan(argument.TokenId), out argument.ReferenceId)))
                {
                    argument.ReferenceKind = ReferenceKind.Boolean;
                }
                else
                {
                    result.ErrorList.Add(new($"The 3-th argument of action 'shiftTroop2' must be Boolean.", result.TokenList[argument.TokenId].Range));
                }

                break;
        }
    }

    public static bool ArgumentCountValidation(ref Context context, ref Result result, ActionKind kind, int count, uint index)
    {
        if (count < 0)
        {
            return false;
        }

		switch (kind)
        {
            case ActionKind.stopTroop:
            case ActionKind.loopBGM:
            case ActionKind.eraseSkill:
            case ActionKind.eraseFriend:
                if (count < 1)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1~.", result.TokenList[index].Range));
                    return false;
                }
                break;
            case ActionKind.msg:
            case ActionKind.msg2:
            case ActionKind.talk:
            case ActionKind.talk2:
            case ActionKind.chat:
            case ActionKind.chat2:
            case ActionKind.@event:
            case ActionKind.changeMaster:
				if (count < 1)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1~3.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 3)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1~3.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.dialog:
            case ActionKind.dialogF:
            case ActionKind.hideImage:
            case ActionKind.hideFace:
            case ActionKind.hidePicture:
            case ActionKind.bg:
            case ActionKind.locate:
            case ActionKind.scroll:
            case ActionKind.addSpot:
            case ActionKind.showSpotMark:
            case ActionKind.resetTruce:
            case ActionKind.resetLeague:
            case ActionKind.resetEnemyPower:
				if (count < 1)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1~2.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 2)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1~2.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.image:
            case ActionKind.image2:
            case ActionKind.showImage:
            case ActionKind.face:
            case ActionKind.face2:
            case ActionKind.showFace:
            case ActionKind.picture:
            case ActionKind.picture2:
            case ActionKind.showPict:
            case ActionKind.showPicture:
				if (count < 1)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1~5.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 5)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1~5.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.stop:
            case ActionKind.win:
            case ActionKind.save:
            case ActionKind.erase:
            case ActionKind.minimap:
            case ActionKind.stopBGM:
            case ActionKind.openGoal:
            case ActionKind.hideSpotMark:
            case ActionKind.closeGoal:
            case ActionKind.hideBlind:
            case ActionKind.playWorld:
            case ActionKind.resetTime:
            case ActionKind.resetZone:
            case ActionKind.showBlind:
            case ActionKind.terminate:
            case ActionKind.backScroll:
            case ActionKind.playBattle:
            case ActionKind.setWorldMusic:
            case ActionKind.resetWorldMusic:
            case ActionKind.clearBattleRecord:
				if (count != 0)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 0.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.add:
            case ActionKind.div:
            case ActionKind.mod:
            case ActionKind.mul:
            case ActionKind.per:
            case ActionKind.set:
            case ActionKind.sub:
            case ActionKind.addv:
            case ActionKind.setv:
            case ActionKind.subv:
            case ActionKind.setPM:
            case ActionKind.setud:
            case ActionKind.title:
            case ActionKind.addstr:
            case ActionKind.addVar:
            case ActionKind.select:
            case ActionKind.setVar:
            case ActionKind.subVar:
            case ActionKind.title2:
            case ActionKind.addCapa:
            case ActionKind.addGain:
            case ActionKind.pushSex:
            case ActionKind.pushVar:
            case ActionKind.setCapa:
            case ActionKind.setDone:
            case ActionKind.setGain:
            case ActionKind.storePM:
            case ActionKind.storeud:
            case ActionKind.addLevel:
            case ActionKind.addLoyal:
            case ActionKind.addMoney:
            case ActionKind.addTrust:
            case ActionKind.hideLink:
            case ActionKind.pushCapa:
            case ActionKind.pushGain:
            case ActionKind.pushItem:
            case ActionKind.pushRank:
            case ActionKind.pushSpot:
            case ActionKind.setLevel:
            case ActionKind.setMoney:
            case ActionKind.hideEscape:
            case ActionKind.addCastle:
            case ActionKind.addMerits:
            case ActionKind.changeMap:
            case ActionKind.formTroop:
            case ActionKind.pushForce:
            case ActionKind.pushLevel:
            case ActionKind.pushLoyal:
            case ActionKind.pushMoney:
            case ActionKind.pushTrain:
            case ActionKind.pushTrust:
            case ActionKind.setCastle:
            case ActionKind.changeRace:
            case ActionKind.pushCastle:
            case ActionKind.pushMerits:
            case ActionKind.setDungeon:
            case ActionKind.speedTroop:
            case ActionKind.unionPower:
            case ActionKind.addTraining:
            case ActionKind.changeClass:
            case ActionKind.pushTrainUp:
            case ActionKind.removeSkill:
            case ActionKind.setTraining:
            case ActionKind.addBaseLevel:
            case ActionKind.changeCastle:
            case ActionKind.setBaseLevel:
            case ActionKind.addTrainingUp:
            case ActionKind.changeDungeon:
            case ActionKind.pushBaseLevel:
            case ActionKind.setTrainingUp:
            case ActionKind.storeNextSpot:
            case ActionKind.storeSkillset:
            case ActionKind.storeTodoUnit:
            case ActionKind.changePowerFix:
            case ActionKind.pushBattleHome:
            case ActionKind.pushBattleRect:
            case ActionKind.storeAliveUnit:
            case ActionKind.changePowerFlag:
            case ActionKind.changePowerName:
            case ActionKind.changeSpotImage:
            case ActionKind.setDungeonFloor:
            case ActionKind.storeRaceOfUnit:
            case ActionKind.storeSpotOfUnit:
            case ActionKind.storeUnitOfSpot:
            case ActionKind.storeClassOfUnit:
            case ActionKind.storePowerOfSpot:
            case ActionKind.storePowerOfUnit:
            case ActionKind.storeSkillOfUnit:
            case ActionKind.storeSpotOfPower:
            case ActionKind.storeTalentPower:
            case ActionKind.storeUnitOfPower:
            case ActionKind.storeLeaderOfSpot:
            case ActionKind.storeMasterOfUnit:
            case ActionKind.storeMemberOfUnit:
            case ActionKind.storePowerOfForce:
            case ActionKind.storeLeaderOfPower:
            case ActionKind.storeMasterOfPower:
            case ActionKind.storeRoamUnitOfSpot:
            case ActionKind.storeBaseClassOfUnit:
                if (count < 2)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 2.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 2)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 2.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.call:
            case ActionKind.zoom:
            case ActionKind.clear:
            case ActionKind.playSE:
            case ActionKind.volume:
            case ActionKind.addItem:
            case ActionKind.routine:
            case ActionKind.scroll2:
            case ActionKind.shuffle:
            case ActionKind.addLimit:
            case ActionKind.addPower:
            case ActionKind.clearVar:
            case ActionKind.exitItem:
            case ActionKind.hideSpot:
            case ActionKind.pushRand:
            case ActionKind.pushTurn:
            case ActionKind.roamUnit:
            case ActionKind.roamUnit2:
            case ActionKind.setLimit:
            case ActionKind.showSpot:
            case ActionKind.showParty:
            case ActionKind.ctrlTroop:
            case ActionKind.entryItem:
            case ActionKind.eraseItem:
            case ActionKind.eraseUnit:
            case ActionKind.freeTroop:
            case ActionKind.haltTroop:
            case ActionKind.hideChara:
            case ActionKind.pushLimit:
            case ActionKind.pushRand2:
            case ActionKind.endingRoll:
            case ActionKind.erasePower:
            case ActionKind.eraseTroop:
            case ActionKind.removeSpot:
            case ActionKind.shuffleVar:
            case ActionKind.sleepTroop:
            case ActionKind.activeTroop:
            case ActionKind.battleEvent:
            case ActionKind.removeTroop:
            case ActionKind.scrollSpeed:
            case ActionKind.showDungeon:
            case ActionKind.unctrlTroop:
            case ActionKind.retreatTroop:
            case ActionKind.reverseChara:
            case ActionKind.showPolitics:
            case ActionKind.storeAllSpot:
            case ActionKind.storeAllPower:
            case ActionKind.storeComPower:
            case ActionKind.storeNowPower:
            case ActionKind.eraseUnitTroop:
            case ActionKind.pushCountPower:
            case ActionKind.storeAllTalent:
            case ActionKind.erasePowerMerce:
            case ActionKind.erasePowerStaff:
            case ActionKind.storeBattleSpot:
            case ActionKind.storePlayerUnit:
            case ActionKind.storeAttackPower:
            case ActionKind.storeNeutralSpot:
            case ActionKind.storePlayerPower:
            case ActionKind.storeDefensePower:
            case ActionKind.storeSpotOfBattle:
            case ActionKind.storePowerOfAttack:
            case ActionKind.storeNonPlayerPower:
            case ActionKind.storePowerOfDefense:
                if (count < 1)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 1)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 1.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.exit:
            case ActionKind.wait:
            case ActionKind.focus:
            case ActionKind.shake:
            case ActionKind.fadein:
            case ActionKind.fadeout:
            case ActionKind.playBGM:
            case ActionKind.reloadMenu:
            case ActionKind.choiceTitle:
            case ActionKind.changePlayer:
            case ActionKind.setGameClear:
				if (count > 1)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 0~1.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.font:
            case ActionKind.fontc:
				if (count > 3)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 0~3.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.gread:
            case ActionKind.pushv:
            case ActionKind.gwrite:
            case ActionKind.addUnit:
            case ActionKind.addDiplo:
            case ActionKind.aimTroop:
            case ActionKind.setDiplo:
            case ActionKind.setTruce:
            case ActionKind.equipItem:
            case ActionKind.setLeague:
            case ActionKind.skillTroop:
				if (count < 2)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 2~3.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 3)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 2~3.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.index:
            case ActionKind.storeIndex:
            case ActionKind.storeIndexVar:
            case ActionKind.pushCon:
            case ActionKind.addStatus:
            case ActionKind.pushDiplo:
            case ActionKind.setArbeit:
            case ActionKind.setStatus:
            case ActionKind.pushStatus:
            case ActionKind.pushSpotPos:
            case ActionKind.setEnemyPower:
                if (count < 3)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 3.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 3)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 3.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.choice:
            case ActionKind.addSkill:
            case ActionKind.addFriend:
            case ActionKind.addSkill2:
            case ActionKind.eraseUnit2:
            case ActionKind.addPowerMerce:
            case ActionKind.addPowerStaff:
            case ActionKind.addPowerMerce2:
            case ActionKind.addPowerStaff2:
                if (count < 2)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 2~.", result.TokenList[index].Range));
                    return false;
                }
                break;
            case ActionKind.shadow:
				if (count > 6)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 0~6.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.doskill:
            case ActionKind.addTroop:
            case ActionKind.storeRectUnit:
                if (count < 5)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 5.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 5)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 5.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.darkness:
				if (count > 4)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 0~4.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.linkSpot:
            case ActionKind.moveTroop:
            case ActionKind.moveTroopFix:
            case ActionKind.smoveTroop:
            case ActionKind.smoveTroopFix:
            case ActionKind.linkEscape:
				if (count < 2)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 2~4.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 4)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 2~4.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.spotmark:
				if (count > 2)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 0~2.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.showChara:
				if (count < 3)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 3~5.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 5)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 3~5.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.shiftTroop:
				if (count < 3)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 3~4.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 4)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 3~4.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
            case ActionKind.shiftTroop2:
                if (count < 4)
                {
                    result.ErrorList.Add(new($"There are too less arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 4.", result.TokenList[index].Range));
                    return false;
                }
                else if (count > 4)
                {
                    if (context.CreateError(DiagnosticSeverity.Warning))
                    {
                        result.ErrorList.Add(new($"There are too many arguments({count}) for '{kind}'. Exceeding arguments are just ignored. Required: 4.", result.TokenList[index].Range, DiagnosticSeverity.Warning));
                    }
                    return false;
                }
                break;
        }
        return true;
	}
}
